<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.6//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_6.dtd'>
<nta>
	<declaration>// Place global declarations here.
</declaration>
	<template>
		<name>Monitor</name>
		<parameter>bool &amp;iniciarEval, bool &amp;iniciarAsis, int &amp;numEval, int &amp;numAsis, bool &amp;iniciarAlerta, bool &amp;terminoAlerta</parameter>
		<declaration>clock t;</declaration>
		<location id="id0" x="-450" y="-51">
			<name x="-460" y="-85">Iniciado</name>
		</location>
		<location id="id1" x="-306" y="-51">
			<name x="-316" y="-85">Esperando</name>
		</location>
		<location id="id2" x="-170" y="-51">
			<name x="-180" y="-85">Procesando</name>
		</location>
		<location id="id3" x="-25" y="-51">
			<name x="-35" y="-85">Finalizado</name>
		</location>
		<init ref="id0"/>
		<transition id="id4">
			<source ref="id3"/>
			<target ref="id1"/>
			<nail x="-76" y="-136"/>
			<nail x="-263" y="-136"/>
		</transition>
		<transition id="id5">
			<source ref="id2"/>
			<target ref="id3"/>
			<label kind="guard" x="-153" y="-34">terminoAlerta == true</label>
		</transition>
		<transition id="id6">
			<source ref="id1"/>
			<target ref="id2"/>
			<label kind="guard" x="-289" y="-34">numEval&gt;=3 &amp;&amp; 
numAsis&gt;=3</label>
			<label kind="assignment" x="-289" y="0">iniciarAlerta = true</label>
		</transition>
		<transition id="id7">
			<source ref="id0"/>
			<target ref="id1"/>
			<label kind="assignment" x="-467" y="-34">iniciarEval = true,
iniciarAsis = true</label>
		</transition>
	</template>
	<template>
		<name x="5" y="5">Alerta</name>
		<parameter>bool &amp;iniciarAlerta, bool &amp;terminoAlerta</parameter>
		<declaration>clock t;</declaration>
		<location id="id8" x="-153" y="0">
			<name x="-178" y="17">Creado</name>
		</location>
		<location id="id9" x="-42" y="0">
			<name x="-85" y="17">Pendiente</name>
		</location>
		<location id="id10" x="127" y="68">
			<name x="110" y="85">Concluido</name>
		</location>
		<location id="id11" x="127" y="-85">
			<name x="110" y="-119">Archivado</name>
		</location>
		<location id="id12" x="-153" y="-93">
			<name x="-195" y="-127">NoExistente</name>
		</location>
		<init ref="id12"/>
		<transition id="id13">
			<source ref="id12"/>
			<target ref="id8"/>
			<label kind="guard" x="-255" y="-68">iniciarAlerta == true</label>
		</transition>
		<transition id="id14">
			<source ref="id9"/>
			<target ref="id10"/>
			<label kind="assignment" x="34" y="8">terminoAlerta = true</label>
		</transition>
		<transition id="id15">
			<source ref="id9"/>
			<target ref="id11"/>
			<label kind="assignment" x="34" y="-42">terminoAlerta = true</label>
		</transition>
		<transition id="id16">
			<source ref="id8"/>
			<target ref="id9"/>
		</transition>
	</template>
	<template>
		<name>Asistencia</name>
		<parameter>bool &amp;iniciarAsis, int &amp;numAsis</parameter>
		<declaration>clock t;</declaration>
		<location id="id17" x="-136" y="17">
			<name x="-146" y="-17">Creado</name>
		</location>
		<location id="id18" x="17" y="17">
			<name x="7" y="-17">Proceso</name>
		</location>
		<location id="id19" x="136" y="17">
			<name x="126" y="-17">Finalizado</name>
		</location>
		<init ref="id17"/>
		<transition id="id20">
			<source ref="id18"/>
			<target ref="id19"/>
			<label kind="assignment" x="42" y="34">numAsis++,
iniciarAsis = true</label>
		</transition>
		<transition id="id21">
			<source ref="id17"/>
			<target ref="id18"/>
			<label kind="guard" x="-144" y="34">iniciarAsis == true</label>
			<label kind="assignment" x="-144" y="51">iniciarAsis = false</label>
		</transition>
	</template>
	<template>
		<name>Evaluacion</name>
		<parameter>bool &amp;iniciarEval, int &amp;numEval</parameter>
		<declaration>clock t;</declaration>
		<location id="id22" x="-136" y="17">
			<name x="-146" y="-17">Creado</name>
		</location>
		<location id="id23" x="17" y="17">
			<name x="7" y="-17">Proceso</name>
		</location>
		<location id="id24" x="136" y="17">
			<name x="126" y="-17">Finalizado</name>
		</location>
		<init ref="id22"/>
		<transition id="id25">
			<source ref="id22"/>
			<target ref="id23"/>
			<label kind="guard" x="-144" y="34">iniciarEval == true</label>
			<label kind="assignment" x="-144" y="51">iniciarEval = false</label>
		</transition>
		<transition id="id26">
			<source ref="id23"/>
			<target ref="id24"/>
			<label kind="assignment" x="42" y="34">numEval++,
iniciarEval = true</label>
		</transition>
	</template>
	<system>int numAsis = 0; //numero de asistencias completadas
int numEval = 0; //numero de evaluaciones completadas
int minPro = 6; //numero minimo a procesar en total
bool iniciarAsis = false; 
bool iniciarEval = false;
bool iniciarAlerta = false;
bool terminoAlerta = false;

asistencia1 = Asistencia(iniciarAsis,numAsis);
asistencia2 = Asistencia(iniciarAsis,numAsis);
asistencia3 = Asistencia(iniciarAsis,numAsis);
evaluacion1 = Evaluacion(iniciarEval,numEval);
evaluacion2 = Evaluacion(iniciarEval,numEval);
evaluacion3 = Evaluacion(iniciarEval,numEval);
alerta = Alerta(iniciarAlerta, terminoAlerta);
monitor = Monitor(iniciarEval, iniciarAsis, numEval, numAsis, iniciarAlerta, terminoAlerta);

// Lista de ejecuciones
system asistencia1, asistencia2, asistencia3, evaluacion1, evaluacion2, evaluacion3, alerta, monitor;
</system>
	<queries>
		<query>
			<formula>E&lt;&gt; (monitor.Finalizado &amp;&amp; alerta.Concluido)</formula>
			<comment>Verifica que existe un camino donde el monitor llega a estado Finalizado y la alerta se concluye exitosamente</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:25 -0500">
			</result>
		</query>
		<query>
			<formula>E&lt;&gt; (monitor.Finalizado &amp;&amp; alerta.Archivado)</formula>
			<comment>Verifica que existe un camino donde el monitor llega a estado Finalizado y la alerta se archiva</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:27 -0500">
			</result>
		</query>
		<query>
			<formula>A[] (numEval &gt;= 0 &amp;&amp; numAsis &gt;= 0)</formula>
			<comment>Verifica que en todos los estados siempre los contadores de evaluaciones y asistencias son no negativos</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:28 -0500">
			</result>
		</query>
		<query>
			<formula>A[] (iniciarAlerta imply (numEval &gt;= 3 &amp;&amp; numAsis &gt;= 3))</formula>
			<comment>Verifica que siempre que se inicia una alerta, se han completado al menos 3 evaluaciones y 3 asistencias</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:29 -0500">
			</result>
		</query>
		<query>
			<formula>E&lt;&gt; (numEval &gt;= 3 &amp;&amp; numAsis &gt;= 3)</formula>
			<comment>Verifica que existe un camino donde se completan al menos 3 evaluaciones y 3 asistencias</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:30 -0500">
			</result>
		</query>
		<query>
			<formula>A[] not deadlock</formula>
			<comment>Verifica que el sistema nunca llega a un estado de bloqueo</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:31 -0500">
			</result>
		</query>
		<query>
			<formula>E&lt;&gt; (monitor.Procesando &amp;&amp; iniciarAlerta == true)</formula>
			<comment>Verifica que existe un camino donde el monitor está procesando y la alerta ha sido iniciada</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:32 -0500">
			</result>
		</query>
		<query>
			<formula>A[] (alerta.Pendiente imply iniciarAlerta == true)</formula>
			<comment>Verifica que siempre que la alerta está pendiente, significa que fue iniciada correctamente</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:33 -0500">
			</result>
		</query>
		<query>
			<formula>E&lt;&gt; (evaluacion1.Finalizado &amp;&amp; evaluacion2.Finalizado &amp;&amp; evaluacion3.Finalizado)</formula>
			<comment>Verifica que existe un camino donde las 3 evaluaciones se completan</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:34 -0500">
			</result>
		</query>
		<query>
			<formula>E&lt;&gt; (asistencia1.Finalizado &amp;&amp; asistencia2.Finalizado &amp;&amp; asistencia3.Finalizado)</formula>
			<comment>Verifica que existe un camino donde las 3 asistencias se completan</comment>
			<result outcome="success" type="quality" timestamp="2025-11-28 16:44:36 -0500">
			</result>
		</query>
	</queries>
</nta>
